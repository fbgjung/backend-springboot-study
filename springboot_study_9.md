### 스프링부트 개념정리 9강 - 톰켓이란 무엇인가요?

#

### 1. 스프링부트 동작 원리

### 1) 내장 톰켓을 가진다.

톰켓을 따로 설치할 필요 없이 바로 실행 가능하다.

- Socket : 운영체제가 가지고 있는 것이다.
- 예시 - A라는 대상과 B라는 대상이 있다. 서로 메시지를 교환하기 위해 운영체제가 제공하는 Soacket을 사용한다.
    - Socket 연결 방법
    1. A가 5000번 port로 Socket을 오픈한다. (port번호 필요)
    2. B는 IP주소와 port번호(5000번)로 연결한다. (IP주소:port번호)
    3. 연결이 완료되면 A와 B는 5000번 port로 서로 메시지 통신이 가능하다.
- 문제1 : C도 A와 통신하고 싶은 경우 A의 5000번 port는 B가 사용중이므로 통신이 불가능하다.
- 해결방법 : 5000번 port는 연결의 용도로 사용한다. 5000번 port로 B가 연결이 되는 순간 새로운 Socket을 랜덤으로 만들어 새로운 Socket(5001번)으로 메시지 통신을 한다.
- 문제2 : A와 B가 서로 통신중이므로 A는 C의 연결 요청을 받을 수 있는 자원이 없다.
- 해결방법 : 새로운 Socket(5001번)을 만들 때는 새로운 스레드(스레드1)를 만든다. (이때 5000번 port는 main 스레드에서 사용한다.) main 스레드는 사용자의 요청을 계속 받고 스레드1은 B와 통신한다. 따라서 C가 5000번 port에 접근하여 새로운 스레드(스레드2)와 소켓(5002번 port)을 랜덤하게 오픈한다. (port 지정 가능)
    - 참고 - 스레드는 시간을 쪼개서 동시에 동작하게 동작하고 있는 것처럼 보일 수 있다. (실제로 동시 동작이 아니고 시간을 나누어서 사용)

- HTTP 방식은 연결을 지속하지 않고 끊는 stateless방식을 사용한다. (HTTP 통신은 문서를 전달하는 통신이다.)
    - HTTP 통신 방법
        1. A가 a.txt 파일 요청
        2. C의 80 port로 요청을 전달받으면 다이렉트로 A에게 a.txt 파일 전달 후 소켓을 끊는다.
        3. B가 b.txt 파일 요청
        4. C의 80 port로 요청을 전달받으면 다이렉트로 B에게 b.txt 파일 전달 후 소켓을 끊는다.
    - HTTP 탄생
        
        스위스 Cern 연구소(입자물리연구소)에서는 학자가 논문을 낼 때 전세계에 있는 자신의 주제와 동일한 내용의 논문을 다 읽어봐야 한다. 다른 방에 있는 논문 또는 컴퓨터로 각각 찾아 봐야 했다. 
        
        각 방의 모든 컴퓨터를 하나의 서버에 연결하여 논문을 서버에 저장한다. 논문이 필요 시 컴퓨터에서 서버로 조회하여 찾아온다. 논문을 한 번 찾으면 연결을 지속할 필요가 없으므로 HTTP 통신으로 만든다. 
        
        HTTP의 목적은 html 확장자로 만들어진 문서를 필요한 사람에게 제공하는 것으로, 문서 전달의 목적이다.
        
        HTTP 창시자 - 팀 버너스리 (2018 개인이 데이터를 통제하는 새로운 웹 진행중)
        

- Socket 방식과 HTTP 방식 비교
    
    Socket 방식은 연결이 계속되므로 부하가 크지만, Socket에 한 번 연결(인증)되면 서버는 연결된 대상을 계속 알고 있다. 
    
    HTTP 방식은 연결이 끊기므로 부하가 적지만, 다시 연결(재연결)되면 항상 새로운 사람으로 인식한다.

#
9강. 톰켓이란 무엇인가요?

- HTTP 통신
    - 프로그램이 운영체제의 기능을 통해서 프로그램을 만드는 것을 시스템콜이라고 한다.
        
        예시) http는 운영체제가 가지고 있는 소켓을 이용하여 만들어져 있다. (http기반 소켓)
        
    - 내 컴퓨터에 동영상이 있고 친구들이 보고 싶어 한다. WWW으로 연결되어 있으니 동영상을 달라고 요청할 수 있다. 내 컴퓨터(웹서버)는 갑이고 친구들은 을이다. 갑(웹서버)은 을이 필요한 데이터를 가지고 있다.
    - HTTP 통신 흐름
        1. 을이 갑에게 request(요청)한다. 
        
        갑의 컴퓨터 위치를 찾아가야 하므로 갑의 IP주소 필요하다. 또한, 어떤 동영상이 필요한지 나타내는 URL(자원 요청 주소(위치))이 필요하다.
        
        1. 갑은 을에게 response(응답)한다.
    - HTTP 통신을 하면 갑은 을의 IP주소를 알지 못한다. 갑이 을의 IP주소를 알고 싶으면 소켓 통신을 해야한다.
    - HTTP 통신은 단순히 요청 시 응답만 해주는 구조이다. 응답은 html문서 또는 특정 자원의 요청에 대해서 응답한다. 이러한 자원을 static 자원이라고 한다. 같은 요청에 대해서 누구에게나 항상 같은 자원(데이터)를 응답하므로 static(정적) 자원이라고 한다.
    
- 웹서버는 흔히 아파치 웹서버를 사용한다.
    - 컴퓨터에 특정 폴더(C\work)를 지정하여 공유한다.
    - 특정 폴더(C\work)의 자원을 request(요청)하면 아파치는 response(응답)하는 구조이다.
    - 만약 요청이 .jsp 또는 자바코드가 적혀 있는 요청을 하게 되면 아파치는 자바 코드를 이해하지 못해 응답이 불가능하다.
    - 따라서 아파치에 톰켓을 추가하여 아파치가 이해하지 못하는 자바코드 요청이 오면 제어권을 톰켓에게 넘긴다. 톰켓은 .jsp 파일 안에 있는 모든 자바 코드를 컴파일하여 컴파일된 데이터를 .html에 덮어씌운다.
        
        ⇒ 톰켓의 역할은 .jsp(자바코드)를 컴파일하고 html문서로 만든다.
        
    - 톰켓은 html 파일을 아파치에게 돌려준다. 아파치는 .html 파일을 response(응답)한다.
        
        (요청은 웹브라우저에서 하기 때문에 html, javascript, css, avi와 같은 정적인 데이터만 이해할 수 있다. .html 파일은 이해할 수 있으나 .jsp로 response받으면 이해할 수 없다.)
        
- 아파치는 요청한 파일을 응답해주는 것이다. 톰켓은 자바코드가 요청한 파일에 있으면 컴파일하여 html로 번역하여 돌려준다.

#

### APACHE(아파치)

- HTTP 웹 서버로, HTML, 이미지와 같은 정적인 데이터를 처리한다.
- 웹 서버는 클라이언트가 GET, POST 등의 메소드를 요청하면 그에 대한 결과를 돌려주는 기능이다.

### TOMCAT(톰켓)

- 동적인 데이터를 처리하는 웹서버로, TOMCAT은 대표적인 WAS이다.
- 자바 서블릿을 실행시키고  jsp코드가 포함되어 있는 웹페이지를 만들어준다.
- 웹서버에서 넘어온 동적인 페이지를 읽어들여 컴파일하여 그 결과를 다시 html로 재구성하여 아파치에게 되돌려 준다.
- WAS(Web Application Server)
    - DB, 로직 처리를 요구하는 동적 타입을 제공하는 소프트웨어 프레임워크이다.
    - 기본적으로 사용되는 기능 3가지
        1. 프로그램 실행 환경과 데이터베이스 접속 기능을 제공한다.
        2. 여러 개의 트랜잭션을 관리한다.
        3. 업무를 처리하는 비즈니스 로직을 수행한다.

### APACHE와 TOMCAT 장단점

|  				| 장점 | 단점 |
| --- 			| --- | --- |
| Apache(static) | 1. 처리 속도가 빠르다.<br>2. 구조가 단순하여 비용이 절감된다.<br>3. 트래픽 과부하에 강하다.  | 1. 정적인 데이터만 처리가 가능하다.<br>2. 다른 서비스와 상호작용 불가능하다. |
| Tomcat(dynamit) | 1. 데이터 흐름이 유동적이다.<br>2. DB 등 다른 응용프로그램과 상호작용이 가능하다. | 1. 아파치에 비해 속도가 느리다.<br>2. 트래픽 과부하게 약하다 |


#

### 참조

<a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC">스프링부트 개념정리(이론)</a><br>
<a href="https://m.blog.naver.com/sincc0715/221815775570">HTTP 아파치(Apache)란 무엇인가? </a><br>
<a href="https://velog.io/@kdhyo/Apache-Tomcat-%EB%91%98%EC%9D%B4-%EB%AC%B4%EC%8A%A8-%EC%B0%A8%EC%9D%B4%EC%A7%80">Apache? Tomcat?? 둘이 무슨 차이지?</a><br>
